    
rule PureCN:
	input:
		segFile = "results/ModelSegments/{tumor}/{tumor}.modelFinal.seg"
	output:
	log:
		"logs/PureCN/{tumor}/PureCN.txt"
	params:
		purecn_intervals = config["purecn_intervals"]
	shell:
		"""
			Rscript /opt/PureCN/PureCN.R \
			--out /cromwell_root/"${sampleID}" \
			--sampleid "${sampleID}" \
			--seg-file "${segFile}" \
			--vcf "${vcf}" \
			--intervals "${intervals}" \
			--genome "${genome}" \
			${"--max-purity " + maxPurity} \
			${"--min-purity " + minPurity} \
			${"--max-copy-number " + maxCopyNumber} \
			${"--fun-segmentation " + funSegmentation} \
			${"--max-segments " + maxSegments} \
			${otherArguments}

			Rscript -e "write.table(read.csv('${sampleID}.csv'),'table.txt',sep='\n',row.names=F,col.names=F,quote=F)"
			Rscript depmap_omics/WGS_pipeline/PureCN_pipeline/call_wgd_and_cin.R "${sampleID}_loh.csv" "${sampleID}.csv"
		"""


